<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RPG Game</title>
  <link href="favicon.ico" rel="icon" type="image/x-icon">
  
  <!-- CSS Files -->
  <link rel="stylesheet" href="css/character-select.css">
  <link rel="stylesheet" href="css/username-overlay.css">
  <link rel="stylesheet" href="css/main-game.css">
  <link rel="stylesheet" href="css/intro-overlay.css">
  <link rel="stylesheet" href="css/additional-styles.css">
</head>

<canvas id="flame-bg"></canvas>
<div id="main-save-ui" style="position:fixed;top:10px;left:10px;z-index:2100;background:#23252a;border-radius:10px;padding:8px 16px;box-shadow:0 2px 12px #0007;display:flex;gap:8px;align-items:center;">
  <button id="main-save-btn" style="font-weight:bold;font-size:1em;background:#ffba3a;color:#23252a;border:none;border-radius:6px;padding:6px 18px;cursor:pointer;">Save</button>
  <button id="main-load-btn" style="font-weight:bold;font-size:1em;background:#35373e;color:#ffba3a;border:none;border-radius:6px;padding:6px 18px;cursor:pointer;">Load Save State</button>
  <input type="file" id="main-load-input" accept=".json,application/json" style="display:none;" multiple>
  <input type="file" id="validation-load-input" accept=".json,application/json" style="display:none;">
</div>
<div id="main-intro-overlay" style="position:fixed;z-index:3000;top:0;left:0;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;color:#fff;font-family:'Arial',sans-serif;background:linear-gradient(135deg, #191a1e 60%, #23252a 100%);background-image:url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1200&q=80');background-size:cover;background-position:center;box-shadow:0 0 120px #23252a inset;">
  
  <!-- Load Save button in top-left corner of overlay -->
  <button id="load-save-btn" style="position:absolute;top:20px;left:20px;z-index:3100;background:#9c27b0;color:#fff;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;font-size:1em;transition:all 0.3s;font-weight:bold;box-shadow:0 4px 12px rgba(156,39,176,0.3);">Load Save</button>
  
  <div style="position:relative;z-index:2;background:rgba(35,37,42,0.95);border-radius:25px;padding:40px;box-shadow:0 10px 40px rgba(0,0,0,0.6);text-align:center;max-width:600px;width:90%;backdrop-filter:blur(10px);">
    
    <div style="margin-bottom:35px;">
      <h3 id="music-title" style="color:#ffba3a;margin:0 0 20px 0;text-align:center;font-size:1.3em;">Background Music</h3>
      <div style="display:flex;gap:12px;justify-content:center;align-items:center;">
        <button id="play-music-btn" disabled style="background:#4caf50;color:#fff;border:none;padding:10px 18px;border-radius:8px;cursor:pointer;font-size:0.95em;transition:all 0.3s;font-weight:bold;opacity:0.5;">Play</button>
        <button id="load-music-btn" style="background:#2196f3;color:#fff;border:none;padding:10px 18px;border-radius:8px;cursor:pointer;font-size:0.95em;transition:all 0.3s;font-weight:bold;">Load Music</button>
        <button id="stop-music-btn" disabled style="background:#f44336;color:#fff;border:none;padding:10px 18px;border-radius:8px;cursor:pointer;font-size:0.95em;transition:all 0.3s;font-weight:bold;opacity:0.5;">Stop</button>
      </div>
      <input type="file" id="music-file-input" accept="audio/*" style="display:none;">
      <input type="file" id="save-file-input" accept=".json,application/json" style="display:none;">
      <audio id="background-audio" loop style="display:none;"></audio>
    </div>

    <div style="margin-bottom:35px;">
      <h2 style="color:#ffba3a;margin:0 0 15px 0;font-size:2em;text-shadow:2px 2px 4px rgba(0,0,0,0.5);">Choose Your Path</h2>
      <p style="color:#ccc;margin:0 0 25px 0;font-size:1.1em;line-height:1.4;">Select your starting class. Each path begins with unique gear and a different story.</p>
      
      <div style="display:flex;gap:20px;justify-content:center;flex-wrap:wrap;">
        <div class="character-class" data-class="melee" style="background:rgba(42,42,62,0.8);border:3px solid transparent;border-radius:15px;padding:25px 20px;cursor:pointer;transition:all 0.3s;text-align:center;min-width:160px;backdrop-filter:blur(5px);">
          <div style="font-size:3.5em;margin-bottom:12px;">‚öîÔ∏è</div>
          <h3 style="color:#ffba3a;margin:0 0 12px 0;font-size:1.3em;font-weight:bold;">Melee</h3>
          <p style="color:#ccc;margin:0;font-size:0.9em;line-height:1.4;">A warrior skilled in close combat. Starts with a sword, shield, and sturdy armor.</p>
        </div>
        
        <div class="character-class" data-class="ranger" style="background:rgba(42,42,62,0.8);border:3px solid transparent;border-radius:15px;padding:25px 20px;cursor:pointer;transition:all 0.3s;text-align:center;min-width:160px;backdrop-filter:blur(5px);">
          <div style="font-size:3.5em;margin-bottom:12px;">üèπ</div>
          <h3 style="color:#ffba3a;margin:0 0 12px 0;font-size:1.3em;font-weight:bold;">Ranger</h3>
          <p style="color:#ccc;margin:0;font-size:0.9em;line-height:1.4;">A master of ranged attacks. Starts with a bow, arrows, and light gear.</p>
        </div>
        
        <div class="character-class" data-class="mage" style="background:rgba(42,42,62,0.8);border:3px solid transparent;border-radius:15px;padding:25px 20px;cursor:pointer;transition:all 0.3s;text-align:center;min-width:160px;backdrop-filter:blur(5px);">
          <div style="font-size:3.5em;margin-bottom:12px;">‚ú®</div>
          <h3 style="color:#ffba3a;margin:0 0 12px 0;font-size:1.3em;font-weight:bold;">Mage</h3>
          <p style="color:#ccc;margin:0;font-size:0.9em;line-height:1.4;">A wielder of arcane power. Starts with a magic staff and enchanted robes.</p>
        </div>
      </div>
    </div>

    <div style="margin-bottom:35px;">
      <h3 style="color:#ffba3a;margin:0 0 15px 0;font-size:1.5em;">Enter Username</h3>
      <input type="text" id="username-input-field" placeholder="Your name..." maxlength="18" style="background:rgba(42,42,62,0.9);color:#fff;border:2px solid #555;border-radius:10px;padding:15px 20px;font-size:1.1em;width:280px;text-align:center;outline:none;transition:all 0.3s;backdrop-filter:blur(5px);">
      <div id="username-error-main" style="color:#ff4444;margin-top:12px;display:none;font-size:0.95em;"></div>
    </div>

    <button id="begin-legend-btn" style="background:linear-gradient(135deg, #ffba3a 0%, #ff8f00 100%);color:#000;border:none;padding:18px 45px;border-radius:12px;font-size:1.4em;font-weight:bold;cursor:pointer;transition:all 0.3s;box-shadow:0 6px 20px rgba(255,186,58,0.4);text-transform:uppercase;letter-spacing:1px;text-shadow:1px 1px 2px rgba(0,0,0,0.2);">Begin Your Legend</button>
  </div>
</div>




<!-- Class Intro Overlay -->
<div id="intro-overlay">
  <div>
    <div id="intro-title">Fate's Awakening</div>
    <div id="intro-story">
    </div>
    <button id="accept-fate-btn" class="accept-fate-pulse">Accept Fate</button>
  </div>
</div>

<div id="explore-bar">
<button id="explore-btn-top" onclick="startExplore()">Explore</button>
</div>
<div id="direction-select-bar">
<span style="color:#ffba3a;font-weight:bold;">Pick a direction:</span>
<button class="direction-btn" onclick="chooseExploreDir(0,-1)">North</button>
<button class="direction-btn" onclick="chooseExploreDir(1,0)">East</button>
<button class="direction-btn" onclick="chooseExploreDir(0,1)">South</button>
<button class="direction-btn" onclick="chooseExploreDir(-1,0)">West</button>
</div>
<div id="container">
<div id="left-col">
<div class="panel" id="player-stats">
<h2>Player Stats</h2>
<ul id="player-stats-ul"></ul>
</div>
<div class="panel" id="equipment">
<h2>Equipment</h2>
<div id="equipment-ui">
<div class="equipment-side left" id="equipment-slots-left"></div>
<div id="char-portrait-box">
<div id="char-portrait"></div>
</div>
<div class="equipment-side right" id="equipment-slots-right"></div>
</div>
<div id="equipment-legend"></div>
</div>
<div class="panel" id="baginv">
<div id="baginv-tabs">
<button class="baginv-tab active" id="tab-inventory" onclick="switchBagInv('inventory')">Inventory</button>
<button class="baginv-tab" id="tab-bag" onclick="switchBagInv('bag')">Bag</button>
</div>
<div id="baginv-content"></div>
</div>
<div class="panel" id="derived-stats">
<h2>Current Stats</h2>
<ul id="derived-stats-list"></ul>
</div>
<div class="panel" id="bank">
<button id="bank-open-btn" onclick="openBank()">Open Bank</button>
</div>
</div>
<div id="center-col">
<div id="enemy-encounter">
<div id="attack-label">ATTACK</div>
<div id="enemy-health-top">
<div id="enemy-hp-bar">
<div id="enemy-hp-bar-inner"></div>
<div id="enemy-hp-bar-text"></div>
</div>
</div>
<div id="enemy-image"></div>
<div id="enemy-name-label"></div>
<div id="enemy-controls">
<button class="enemy-action-btn" id="attack-enemy-btn" onclick="attackEnemy()">Attack</button>
<button class="enemy-action-btn" id="run-enemy-btn" onclick="runFromEnemy()">Run</button>
</div>
</div>
<div id="chest-encounter">
<h3>Chest Found!</h3>
<div class="chest-reward" id="chest-reward"></div>
<button class="chest-btn" onclick="closeChest()">Close</button>
</div>
</div>
<div id="right-col">
<div class="panel" id="map">
<div id="map-container">
<div id="map-index">
<div class="map-index-item"><span class="map-index-color" style="background:#e53935"></span>Central Town</div>
<div class="map-index-item"><span class="map-index-color" style="background:#3887e0"></span>Town</div>
<div class="map-index-item"><span class="map-index-color" style="background:#444"></span>Area (Undiscovered)</div>
<div class="map-index-item"><span class="map-index-color" style="background:#2e7d32"></span>Area (Discovered)</div>
<div class="map-index-item"><span class="map-index-color" style="background:#bfae44"></span>Chest</div>

</div>
<div id="game-map"></div>
<div id="map-controls">

</div>
</script>
<div id="map-area-label"></div>
</div>
</div>
<!-- SHOP PANEL OVERHAUL -->
<div class="panel" id="shop" style="margin-top:18px; position:relative; overflow:visible;">
  <!-- Shop Banner (shown by default) -->
  <div id="shop-banner" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 0;">
    <div style="font-size:2em;color:#ffba3a;font-weight:bold;margin-bottom:18px;">Welcome to the Shop</div>
    <button id="open-shop-btn" style="font-size:1.15em;background:#ffba3a;color:#23252a;border:none;border-radius:10px;padding:12px 38px;cursor:pointer;box-shadow:0 2px 14px #0006;font-weight:bold;letter-spacing:1.5px;transition:background 0.18s, color 0.18s;">Open Shop</button>
  </div>
  <!-- Curtain effect overlay (horizontal animation) -->
  <div id="shop-curtain" style="display:none;position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(90deg,#23252a 80%,#ffba3a 100%);z-index:100;pointer-events:none;opacity:1;transition:opacity 1.1s cubic-bezier(.59,.22,.44,1.36);"></div>
  <!-- Shop Items List (hidden by default) -->
  <div id="shop-items-list" style="margin-top:12px;display:none;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px;">
    <!-- Shop items will be rendered here -->
  </div>
  <div id="shop-controls" style="display:none;margin-top:12px;">
    <button id="refresh-shop-btn" style="font-size:1em;background:#35373e;color:#ffba3a;border:none;border-radius:6px;padding:6px 18px;cursor:pointer;box-shadow:0 2px 8px #0004;">Refresh</button>
  </div>
  
  
</div>
<div class="panel" id="log-panel" style="grid-column:1/4;max-width:none;width:100%;margin-top:0;">
  <div id="game-log"></div>
</div>
</div>
</div>
<div id="bank-modal-bg" style="display:none;position:fixed;z-index:1200;top:0;left:0;width:100vw;height:100vh;background:#18191cbb;align-items:center;justify-content:center;">
  <div id="bank" style="background:#23252a;border-radius:18px;box-shadow:0 0 44px #000c,0 5px 32px #2b2a2a45;padding:32px 29px 24px 29px;min-width:450px;min-height:320px;position:relative;z-index:1211;display:flex;flex-direction:column;">
    <button id="bank-close-btn" onclick="closeBank()" style="position:absolute;top:12px;right:16px;font-size:1.38em;background:none;border:none;color:#fff;cursor:pointer;">√ó</button>
    <div id="bank-content" style="display:flex;flex-direction:column;gap:18px;margin-top:14px;justify-content:center;align-items:flex-start;">
      <!-- Bank Gold and Deposit section (top row) -->
      <div style="display:flex;align-items:center;gap:18px;">
        <div style="font-weight:bold;color:#ffba3a;">Bank Gold: <span id="bank-gold-label"></span></div>
        <div>
          <input type="number" id="deposit-gold-amount" min="1" placeholder="Gold to deposit" style="width:120px;padding:4px 8px;border-radius:5px;border:1px solid #444;background:#18191c;color:#fff;">
          <button id="deposit-gold-btn" style="background:#ffba3a;color:#23252a;border:none;border-radius:6px;padding:6px 18px;font-weight:bold;cursor:pointer;">Deposit Gold</button>
        </div>
        <div>
          <input type="number" id="withdraw-gold-amount" min="1" placeholder="Gold to withdraw" style="width:120px;padding:4px 8px;border-radius:5px;border:1px solid #444;background:#18191c;color:#fff;">
          <button id="withdraw-gold-btn" style="background:#35373e;color:#ffba3a;border:none;border-radius:6px;padding:6px 18px;font-weight:bold;cursor:pointer;">Withdraw Gold</button>
        </div>
      </div>
      <!-- Inventory/Bag section (below bank gold/deposit) -->
      <div class="bank-section">
        <div style="font-weight:bold;color:#ffba3a;margin-bottom:7px;">Inventory/Bag</div>
        <div class="bank-list" id="bank-inv-list"></div>
      </div>
      <div class="bank-section">
        <div style="font-weight:bold;color:#ffba3a;margin-bottom:7px;">Bank Items</div>
        <div class="bank-list" id="bank-list"></div>
      </div>
    </div>
    
  </div>
</div>
    </script>
  </div>
</div>
</script>
</div>
</div>
</div>
</div>


<!-- JavaScript Files -->
<script src="js/modules/intro-flames.js"></script>
<script src="js/modules/main-intro.js"></script>
<script src="js/modules/music-loader.js"></script>
<script src="js/modules/intro-story.js"></script>
<script src="js/modules/story-modal.js"></script>
<script src="js/game-core.js"></script>
<script src="js/modules/debug-mode.js"></script>

</html>
